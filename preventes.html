<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Pr√©ventes en ligne</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- HEADER -->
  <header class="navbar">
    <div class="logo">
      <a href="index.html">
        <img src="logo.png" alt="Logo Comp'Act" class="logo-img" style="height: 70px;">
      </a>
    </div>
    <nav class="main-nav">
      <a href="index.html">Accueil</a>
      <a href="preventes.html">Pr√©ventes</a>
      <a href="conseils.html">Conseils</a>
      <a href="contact.html">Contactez-nous</a>
      <div class="dropdown">
        
          <a href="#" class="dropbtn">More ‚ñº</a>
          <div class="dropdown-content">
            <a href="apropos.html">√Ä propos</a>
            <a href="avis.html">Avis</a>
            <a href="donne.html">Donne ton Compost</a>
          </div>
        </div>
    </nav>
    <div class="nav-icons">
      <a href="login.html" class="nav-btn">Se connecter</a>
      <a href="#" id="open-cart" class="nav-btn" style="position: relative;">
        Panier
        <span id="cart-count" style="position: absolute; top: -8px; right: -8px; background: red; color: white; font-size: 12px; padding: 2px 5px; border-radius: 50%; display: none;">0</span>
      </a>
    </div>
  </header>

  <!-- MAIN -->
  <main class="product-page">
    <div class="product-container">
      <!-- Colonne gauche : images -->
      <div class="product-images">
        <img id="main-image" src="composte1.png" alt="Composteur" class="main-image fly-img">
        <div class="thumbnail-row">
          <img src="composte1.png" class="thumbnail" alt="Vue 1" style="width: 60px; height: 40px; cursor: pointer;">
          <img src="composte2.png" class="thumbnail" alt="Vue 2" style="width: 60px; height: 40px; cursor: pointer;">
          <img src="composte3.png" class="thumbnail" alt="Vue 3" style="width: 60px; height: 40px; cursor: pointer;">
          <img src="composte4.png" class="thumbnail" alt="Vue 4" style="width: 60px; height: 40px; cursor: pointer;">
          <video class="thumbnail" muted autoplay loop style="width: 60px; height: 40px; cursor: pointer; object-fit: cover;">
            <source src="tour.mp4" type="video/mp4">
            Votre navigateur ne supporte pas la lecture de vid√©o.
          </video>
        </div>
      </div>

      <!-- Colonne droite : infos produit -->
      <div class="product-info">
        <h1>Composte d'int√©rieur </h1>
        <div class="price">193.6 ‚Ç¨ <span class="tva">TTC</span></div>

        <div class="quantity-selector">
          <button id="decrease">-</button>
          <span id="quantity">1</span>
          <button id="increase">+</button>
        </div>

        <button class="add-to-cart" id="add-to-cart">Ajoutez au panier</button>

        <div class="delivery-info">
          <p><strong>Livraison inclue.</strong> Livraison en septembre</p>
          <p>Notre site utilise un syst√®me de pr√©ventes pour les commandes du produit. La prochaine pr√©-commande sera livr√©e en septembre 2025.</span></p>
          
          <p><small>Num√©ro d'article : 100275841</small></p>
        </div>
      </div>
    </div>

    <!-- Description -->
    <section class="product-description">
      <h2>Description</h2>
      <table>
        <tr>
          <th colspan="2">Le compostage des d√©chets pour tous, m√™me en appartement</th>
        </tr>
        <tr>
          <td><strong>Dimensions :</strong></td>
          <td>env. 60 x 30 x 30 cm</td>
        </tr>
        <tr>
          <td><strong>Description :</strong></td>
          <td>
            <ul>
              <li>Aidez l'environnement en compostant vos d√©chets de fa√ßon √©cologique</li>
              <li>R√©sistant au compostage √† chaud permettant un compostage rapide</li>
              <li>Couvercle avec joint limitant les odeurs et les insectes</li>
              <li>Pastille de charbon actif pour √©liminer les odeurs</li>
            </ul>
          </td>
        </tr>
        <tr>
          <td><strong>Mati√®re :</strong></td>
          <td>Bois et film en poly√©thyl√®ne</td>
        </tr>
        <tr>
          <td><strong>Contenu :</strong></td>
          <td>env. 40 l </td>
        </tr>
      </table>
    </section>
  </main>

  <!-- FOOTER -->
  <footer>
    <p>¬© 2025 by Comp'Act</p>
  </footer>

  <!-- SIDEBAR PANIER -->
  <div id="cart-sidebar" class="cart-sidebar">
    <div class="cart-header">
      <span>üõí Votre Panier</span>
      <button id="close-cart">‚úñ</button>
    </div>
    <div id="cart-content">
      <!-- Les produits seront inject√©s ici -->
    </div>
  </div>
  
  <div id="cart-overlay" class="cart-overlay"></div>
  

  <!-- SCRIPT -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const openCartBtn = document.getElementById('open-cart');
      const cartSidebar = document.getElementById('cart-sidebar');
      const cartOverlay = document.getElementById('cart-overlay');
      const closeCartBtn = document.getElementById('close-cart');
      const cartCount = document.getElementById('cart-count');
      const cartContent = document.getElementById('cart-content');
      const quantityDisplay = document.getElementById('quantity');
      const increaseBtn = document.getElementById('increase');
      const decreaseBtn = document.getElementById('decrease');
      const addToCartBtn = document.getElementById('add-to-cart');
      const thumbnails = document.querySelectorAll('.thumbnail');
      const mainImage = document.getElementById('main-image');

      
let currentMainMedia = document.getElementById('main-image');

thumbnails.forEach(thumbnail => {
  thumbnail.addEventListener('click', function () {
    // Si on clique sur une miniature image
    if (this.tagName.toLowerCase() === 'img') {
      const newImage = document.createElement('img');
      newImage.src = this.src;
      newImage.id = 'main-image';
      newImage.className = 'main-image fly-img';
      newImage.alt = 'Composteur';
      newImage.style.width = '100%';
      newImage.style.borderRadius = '8px';

      currentMainMedia.replaceWith(newImage);
      currentMainMedia = newImage;
    }
  });
});

// Pour la miniature vid√©o
const videoThumbnail = document.querySelector('video.thumbnail');
videoThumbnail.addEventListener('click', function () {
  const video = document.createElement('video');
  video.src = 'tour.mp4';
  video.id = 'main-image';
  video.className = 'main-image';
  video.controls = true;
  video.autoplay = true;
  video.style.width = '100%';
  video.style.borderRadius = '8px';

  currentMainMedia.replaceWith(video);
  currentMainMedia = video;
});

    
      let currentQuantity = 1;
    
      function updateCartDisplay() {
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        let totalItems = 0;
        let totalPrice = 0;

        if (cart.length === 0) {
          cartContent.innerHTML = `
            <div style="text-align: center; padding: 20px;">
              <img src="composte1.png" alt="Panier vide" style="width: 150px; margin-bottom: 20px;">
              <h3>Votre panier est vide !</h3>
              <p>Ajoutez l'article √† votre panier.</p>
              <button onclick="window.location.href='preventes.html'" style="margin-top: 10px; background-color: #1e4745; color: white; border: none; padding: 10px 20px; border-radius: 30px; font-size: 16px; cursor: pointer;">
                D√©couvrir le produit
              </button>
            </div>
          `;
          cartCount.textContent = 0;
          cartCount.style.display = 'none'; // ou 'inline-block' selon ton besoin
          return;
        }

        // Si panier non vide
        const itemsHTML = cart.map(item => {
          totalItems += item.quantity;
          totalPrice += item.price * item.quantity;
          return `
            <div class="cart-item-mini" style="display: flex; align-items: center; margin-bottom: 10px;">
              <div>
                <p style="margin: 0;">${item.name} √ó ${item.quantity}</p>
                <p style="margin: 0; font-size: 14px; color: gray;">${(item.price * item.quantity).toFixed(2)} ‚Ç¨</p>
              </div>
            </div>
          `;
        }).join('');

        cartContent.innerHTML = `
          ${itemsHTML}
          <div style="text-align: right; margin-top: 15px; font-weight: bold;">
            Total : ${totalPrice.toFixed(2)} ‚Ç¨
          </div>
          <div style="margin-top: 20px; display: flex; flex-direction: column; gap: 10px;">
            <button onclick="window.location.href='preventes.html'" style="background-color: #ccc; color: #333; border: none; padding: 10px; border-radius: 30px; font-size: 16px; cursor: pointer;">
              Poursuivre mes achats
            </button>
            <button onclick="window.location.href='panier.html'" style="background-color: #1e4745; color: white; border: none; padding: 10px; border-radius: 30px; font-size: 16px; cursor: pointer;">
              Passer la commande
            </button>
          </div>
        `;

        cartCount.textContent = totalItems;
        cartCount.style.display = 'inline-block';
      }



    
      function openCart() {
        updateCartDisplay();
        cartSidebar.classList.add('active');
        cartOverlay.classList.add('active');
      }
    
      function closeCart() {
        cartSidebar.classList.remove('active');
        cartOverlay.classList.remove('active');
      }
    
      function addToCart(name, price, image, quantity) {
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        const existingItem = cart.find(item => item.name === name);
        const img = document.getElementById('main-image');
const cartIcon = document.getElementById('open-cart');

      const imgClone = img.cloneNode(true);
      imgClone.classList.add('fly-img-clone');
      document.body.appendChild(imgClone);

      const imgRect = img.getBoundingClientRect();
      const cartRect = cartIcon.getBoundingClientRect();

      imgClone.style.top = imgRect.top + 'px';
      imgClone.style.left = imgRect.left + 'px';

      requestAnimationFrame(() => {
        imgClone.style.top = cartRect.top + 'px';
        imgClone.style.left = cartRect.left + 'px';
        imgClone.style.transform = 'scale(0.1)';
        imgClone.style.opacity = '0';
      });

      // Supprimer le clone apr√®s l'animation
      setTimeout(() => {
        document.body.removeChild(imgClone);
        openCart();
      }, 1000);
    
        if (existingItem) {
          existingItem.quantity += quantity;
        } else {
          cart.push({ name, price, image, quantity });
        }
    
        localStorage.setItem('cart', JSON.stringify(cart));
        
      }
      
    
      // Gestion du + et -
      increaseBtn.addEventListener('click', function () {
        currentQuantity++;
        quantityDisplay.textContent = currentQuantity;
      });
    
      decreaseBtn.addEventListener('click', function () {
        if (currentQuantity > 1) {
          currentQuantity--;
          quantityDisplay.textContent = currentQuantity;
        }
      });
    
      // Clic sur "Ajouter au panier"
      addToCartBtn.addEventListener('click', function () {
        const productName = "Comp'Act";
        const productPrice = 193.6;
        const productImage = document.getElementById('main-image').src;
        addToCart(productName, productPrice, productImage, currentQuantity);
        currentQuantity = 1;
        quantityDisplay.textContent = currentQuantity;
      });
    
      // Event listeners pour ouvrir / fermer le panier
      openCartBtn.addEventListener('click', function (e) {
        e.preventDefault();
        
      });
    
      closeCartBtn.addEventListener('click', closeCart);
      cartOverlay.addEventListener('click', closeCart);
    
      // Initialiser l'affichage
      updateCartDisplay();
    });
    </script>
    
    
    

</body>
</html>
